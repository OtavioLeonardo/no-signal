---
import Base from '@/layouts/Base.astro';
import Section from '@/components/Section.astro';

// 接收 frontmatter 数据
const { frontmatter } = Astro.props;

// 格式化日期：例如 "2026年1月27日 星期二"
const formattedDate = new Date(frontmatter.pubDate).toLocaleDateString('zh-CN', {
	year: 'numeric',
	month: 'long',
	day: 'numeric',
	weekday: 'long'
});
---

<Base head={{ title: frontmatter.title, description: frontmatter.description }}>
	<Section>
		{/* 顶部导航 */}
		<div class="py-6">
			<a 
				href="/diary" 
				class="inline-flex items-center gap-1 text-sm text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white transition-colors"
			>
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"/></svg>
				<span>Back to Diary</span>
			</a>
		</div>

		{/* Apple Card 风格容器：白色背景，阴影，圆角 */}
		<article class="apple-card mx-auto w-full max-w-2xl p-8 md:p-12">
			
			{/* 1. 日记头部信息 */}
			<header class="mb-10 text-center">
				<time class="block text-gray-400 text-sm font-medium mb-3 uppercase tracking-wide">
					{formattedDate}
				</time>
				<h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white leading-tight tracking-tight">
					{frontmatter.title}
				</h1>
			</header>

			{/* 2. 摘要 - 优化为柔和的背景块 */}
			{frontmatter.excerpt && (
				<div class="mb-10 rounded-2xl bg-gray-50 dark:bg-white/5 p-6 text-center">
					<p class="text-base italic text-gray-600 dark:text-gray-300">
						{frontmatter.excerpt}
					</p>
				</div>
			)}

			{/* 3. 配图 */}
			{frontmatter.image?.src && (
				<div class="mb-10">
					<img 
						src={frontmatter.image.src} 
						alt={frontmatter.image.alt || frontmatter.title} 
						class="w-full h-auto rounded-xl shadow-sm"
					/>
					{frontmatter.image.alt && (
						<p class="mt-3 text-center text-xs text-gray-400">
							▲ {frontmatter.image.alt}
						</p>
					)}
				</div>
			)}

			{/* 4. 正文内容 */}
			{/* 移除 prose-stone，使用默认的 prose (gray)，在 global.css 中已微调 */}
			<div class="prose prose-lg dark:prose-invert max-w-none 
				prose-headings:font-bold prose-headings:tracking-tight
				prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
				prose-img:rounded-xl prose-img:shadow-sm">
				
				<slot />
				
			</div>

			{/* 底部装饰 */}
			<div class="mt-16 flex justify-center opacity-30">
				<div class="w-16 h-1 rounded-full bg-gray-300 dark:bg-gray-700"></div>
			</div>
		</article>
	</Section>
</Base>