@import "tailwindcss";

@plugin "@tailwindcss/typography";

@custom-variant dark (&:where(.dark, .dark *));

/* Tailwind doesn't fully support some of the complex CSS selectors needed for code highlighting,
so we need to keep some custom CSS but applied through Tailwind's plugin system
These styles are for code highlighting that can't be easily implemented with just Tailwind */
@layer utilities {
    .content pre {
        @apply p-0;
    }

    .content code {
        @apply overflow-x-auto;
    }

    .content [data-rehype-pretty-code-figure] code {
        @apply p-0;
    }

    .content pre>code span[data-line] {
        @apply border-l-8 border-transparent px-2;
    }

    .content pre>code span:first-of-type {
        @apply rounded-t-lg pt-2;
    }

    .content pre>code span:last-of-type {
        @apply rounded-b-lg pb-2;
    }

    .content pre>code .highlighted {
        @apply border-l-8 !border-gray-300/60 bg-gray-200/5;
    }

    .content pre>code[data-line-numbers] {
        counter-reset: line;
    }

    .content pre>code[data-line-numbers]>span[data-line]::before {
        counter-increment: line;
        content: counter(line);
        @apply mr-8 inline-block w-4 text-left text-[#7ca2dfad];
    }

    .content pre>code>span[data-line]::before {
        content: '';
        @apply inline-block w-4 text-right;
    }

    .content pre>code[data-line-numbers-max-digits='2']>span[data-line]::before {
        @apply w-8;
    }

    .content code[data-line-numbers-max-digits='3']>span[data-line]::before {
        @apply w-12;
    }
}

/* ... ä¸Šé¢æ˜¯ä½ åŽŸæœ¬çš„ä»£ç¢¼ ... */

/* --- Obsidian/GitHub Callout æ ·å¼ (Emoji ç‰ˆ) --- */
@layer components {

    /* åŸºç¡€å®¹å™¨ */
    .markdown-alert {
        @apply mb-4 border-l-4 rounded-r-lg p-4 text-sm bg-[var(--alert-bg)] border-[var(--alert-border)];
    }

    /* æ ‡é¢˜æ ·å¼ */
    .markdown-alert-title {
        @apply flex items-center font-bold mb-2 text-[var(--alert-color)];
    }

    /* å†…å®¹æœ€åŽä¸€æ®µä¸ç•™ margin */
    .markdown-alert>*:last-child {
        @apply mb-0;
    }

    /* --- å›¾æ ‡é€šç”¨è®¾ç½® (Emoji) --- */
    .markdown-alert-title::before {
        @apply inline-block mr-2 text-lg leading-none not-italic;
        /* å¼ºåˆ¶ä½¿ç”¨ Emoji å­—ä½“ï¼Œé˜²æ­¢è¢«ç³»ç»Ÿå­—ä½“è¦†ç›– */
        font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
    }

    /* --- å„ç±»åž‹å®šä¹‰ (é¢œè‰²å˜é‡ + Emoji Content) --- */

    /* 1. Important (ç´«è‰²) -> ðŸ’¬ */
    .markdown-alert-important {
        --alert-color: #7e22ce;
        /* purple-700 */
        --alert-bg: #faf5ff;
        /* purple-50 */
        --alert-border: #a855f7;
        /* purple-500 */

        &:where(.dark, .dark *) {
            --alert-color: #d8b4fe;
            --alert-bg: #3b0764;
            --alert-border: #9333ea;
        }
    }

    .markdown-alert-important .markdown-alert-title::before {
        content: "ðŸ’¬";
    }

    /* 2. Note (è“è‰²) -> â„¹ï¸ */
    .markdown-alert-note {
        --alert-color: #1d4ed8;
        /* blue-700 */
        --alert-bg: #eff6ff;
        /* blue-50 */
        --alert-border: #3b82f6;
        /* blue-500 */

        &:where(.dark, .dark *) {
            --alert-color: #93c5fd;
            --alert-bg: #172554;
            --alert-border: #2563eb;
        }
    }

    .markdown-alert-note .markdown-alert-title::before {
        content: "â„¹ï¸";
    }

    /* 3. Tip (ç»¿è‰²) -> ðŸ’¡ */
    .markdown-alert-tip {
        --alert-color: #15803d;
        /* green-700 */
        --alert-bg: #f0fdf4;
        /* green-50 */
        --alert-border: #22c55e;
        /* green-500 */

        &:where(.dark, .dark *) {
            --alert-color: #86efac;
            --alert-bg: #052e16;
            --alert-border: #16a34a;
        }
    }

    .markdown-alert-tip .markdown-alert-title::before {
        content: "ðŸ’¡";
    }

    /* 4. Warning (æ©™è‰²) -> âš ï¸ */
    .markdown-alert-warning {
        --alert-color: #c2410c;
        /* orange-700 */
        --alert-bg: #fff7ed;
        /* orange-50 */
        --alert-border: #f97316;
        /* orange-500 */

        &:where(.dark, .dark *) {
            --alert-color: #fdba74;
            --alert-bg: #431407;
            --alert-border: #ea580c;
        }
    }

    .markdown-alert-warning .markdown-alert-title::before {
        content: "âš ï¸";
    }

    /* 5. Caution (çº¢è‰²) -> ðŸ›‘ */
    .markdown-alert-caution {
        --alert-color: #b91c1c;
        /* red-700 */
        --alert-bg: #fef2f2;
        /* red-50 */
        --alert-border: #ef4444;
        /* red-500 */

        &:where(.dark, .dark *) {
            --alert-color: #fca5a5;
            --alert-bg: #450a0a;
            --alert-border: #dc2626;
        }
    }

    .markdown-alert-caution .markdown-alert-title::before {
        content: "ðŸ›‘";
    }
}