---
import Base from '@/layouts/Base.astro';
import Section from '@/components/Section.astro';
import { AppConfig } from '@/utils/AppConfig';
import { getEntry } from 'astro:content';

// 1. 获取数据
const nowPage = await getEntry('pages', 'now');
if (!nowPage) {
  return new Response('请先去 Keystatic 后台创建 Now 页面内容', { status: 404 });
}

const { title } = AppConfig;
const { updatedDate } = nowPage.data;
const { Content } = await nowPage.render();

// 格式化日期: 使用更有质感的英文格式，或者你喜欢的中文格式
const lastUpdated = new Date(updatedDate).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
});
---

<Base head={{ title: `Now - ${title}`, description: "What I'm doing now" }}>
    
    {/* Header Area: 居中大标题 */}
    <Section>
        <div class="py-12 md:py-20 text-center border-b border-gray-100 dark:border-white/5">
            <h1 class="text-4xl md:text-6xl font-bold tracking-tight text-gray-900 dark:text-white mb-6">
                Now
            </h1>
            
            <div class="max-w-2xl mx-auto space-y-6">
                <p class="text-lg text-gray-500 font-medium leading-relaxed">
                    这不是关于我是谁，而是关于我<span class="text-gray-900 dark:text-white font-semibold">此时此刻</span>在做什么。
                </p>

                {/* Update Badge: iOS 风格胶囊 */}
                <div class="inline-flex items-center px-3 py-1 rounded-full bg-gray-100 dark:bg-white/10 border border-gray-200 dark:border-white/5">
                    <span class="relative flex h-2 w-2 mr-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                    </span>
                    <span class="text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide">
                        Updated: {lastUpdated}
                    </span>
                </div>
            </div>
        </div>
    </Section>

    <Section>
        <div class="py-10 md:py-16">
            {/* Prose 内容区: 
                - prose-gray: 中性灰
                - prose-a:text-blue-600: 链接改为蓝色
                - prose-img:rounded-2xl: 图片圆角统一
            */}
            <div class="mx-auto prose prose-lg prose-gray dark:prose-invert max-w-3xl
                prose-headings:font-bold prose-headings:tracking-tight prose-headings:text-gray-900 dark:prose-headings:text-white
                prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline
                prose-img:rounded-2xl prose-img:shadow-sm
                prose-li:marker:text-gray-300">
                
                <Content />
                
            </div>
        </div>
        
        {/* 底部签名装饰 */}
        <div class="pb-20 text-center opacity-30">
            <span class="font-handwriting text-2xl">~ Enjoy the moment</span>
        </div>
    </Section>
</Base>